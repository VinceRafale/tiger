{% extends 'dashboard.html' %}

{% block extrahead %}
{{ block.super }}
<link rel='stylesheet' type='text/css' href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/start/jquery-ui.css' />
<link rel='stylesheet' type='text/css' href='{{ MEDIA_URL }}js/jquery.weekcalendar.css' />

<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js'></script>
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js'></script>
<script type='text/javascript' src='{{ MEDIA_URL }}js/jquery.weekcalendar.js.min.js'></script>

{% endblock %}

{% block title %}{% endblock %}

{% block content %}
<h1>Your restaurant hours</h1>
<p>Please edit the hours that you are open on the calendar below. To remove a timeslot, click it.</p>
<div id="calendar"></div>
{% endblock %}

{% block js %}
{% load calendar_tags %}
<script type="text/javascript">
$(function () {
    $("#calendar").weekCalendar({
        buttons: false, 
        timeslotsPerHour: 2, 
        newEventText: 'Open',
        dateFormat: "",
        data: {events: {% get_user_timeslots %} },
        businessHours :{start: 5, end: 24, limitDisplay: true},
        eventNew: function (calEvent, element) {
            $.post("{% url save_timeslot %}", calEvent); 
            appendLink(element);
        },
        eventDrop: function (calEvent, element) {
            $.post("{% url update_timeslot %}", calEvent); 
        },
        eventResize: function (calEvent, element) {
            $.post("{% url update_timeslot %}", calEvent); 
        },
        eventClick: function (calEvent, element) {
            c = confirm("Do you want to remove this event?");
            if (c) {
                $.post("{% url delete_timeslot %}", calEvent); 
                $("#calendar").weekCalendar("removeEvent", calEvent.id);
            }
            return false;
        }
    });
});
</script>
{% endblock %}
