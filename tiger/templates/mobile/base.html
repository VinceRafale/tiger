{% load compress %}
{% load stork_tags %}
<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>
        <link rel="apple-touch-icon-precomposed" href="http://media.meirish.com/images/appIcon.png">
        <title>{{ site.name }}</title>
        <style id="font-face-fonts">
        {% if not fonts_are_cached %}
        {% for fontname, attrs in site.font_data.data.items %}
        {{ attrs.font_face }}
        {% endfor %}
        {% endif %}
        </style>
        <script type='text/javascript'>
        var font_key = "{{ font_key }}",
            font_face_tag = document.getElementById("font-face-fonts");

        function createCookie(name,value,days) {
            if (days) {
                var date = new Date();
                date.setTime(date.getTime()+(days*24*60*60*1000));
                var expires = "; expires="+date.toGMTString();
            }
            else var expires = "";
            document.cookie = name+"="+value+expires+"; path=/";
        }

        function readCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for(var i=0;i < ca.length;i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
            }
            return null;
        }

        if (readCookie("font_key") !== font_key) {
            localStorage.setItem("fontface", font_face_tag.innerHTML);
            createCookie("font_key", font_key, 365);
        } else {
            font_face_tag.innerHTML = localStorage.getItem("fontface");
        }
        </script>
        {% compress css %}
        <style type="text/x-scss" media="screen">
        /* HEY MATTHEW MAKE ME MO BETTA */
        span.error {
            display:block;
            background-color:#eebbbb;
            color:#552222;
        }
        {% build_css site.theme %}
        {% for fontname, attrs in site.font_data.data.items %}
        ${{ fontname }}: {{ fontname }}, {{ attrs.stack|safe }};
        {% endfor %}


//$headerfontcolor: rgba(119,255,0,1.0);
//$bodyfontcolor: rgba(255,255,255,1.0);
//$accentcolor: rgba(247,10,10,1.0);
//$centercolor: rgba(0,0,0,1.0);
//$backgroundcolor: rgba(0,0,0,1.0);
//$mastheadbackgroundcolor: rgba(0,0,0,1.0);
//$mastheadtextcolor: rgba(145,255,0,1.0);
//$menuitembackground: rgba(247,255,0,1.0);
//$menuitembackgroundhover: rgba(255,255,0,1.0);
//$menuitemtext: rgba(0,0,0,1.0);
//$menuitemtexthover: rgba(0,0,0,1.0);
//$menubackgroundcolor: rgba(247,255,0,1.0);
//$buttoncolor: rgba(255,255,0,1.0);
//$buttonbackgroundhover: rgba(255,255,0,1.0);
//$buttontext: rgba(0,0,0,1.0);
//$buttontexthover: rgba(0,0,0,1.0);
//$orderbuttonbackground: rgba(255,255,0,1.0);
//$orderbuttonbackgroundhover: rgba(255,255,0,1.0);
//$orderbuttontext: rgba(0,0,0,1.0);
//$orderbuttontexthover: rgba(0,0,0,1.0);
//$footerbackground: rgba(247,255,0,1.0);
//$footertext: rgba(0,0,0,1.0);
//$footerlink: rgba(0,0,0,1.0);
//$footerlinkhover: rgba(0,0,0,1.0)

@mixin button{
  border-radius:5px;
    color: $buttontext;
    text-decoration: none;
    background-color: $buttoncolor;
    padding: 5px 10px;
    display: inline-block;
    margin: 0 2px;
}
.btn{
  @include button;
  margin:.5rem 0;
}
@mixin border-box{
  -webkit-box-sizing: border-box;
    box-sizing: border-box;
}
@mixin round-corners($radius){
  border-radius: $radius;
}
@mixin ul-reset{
  padding: 0;
    margin: 0;
    list-style-type:none;
}
body, html{
  overflow-x: hidden;
    margin: 0; 
    padding: 0;
    background-color: $centercolor;
    font-size: 15px;
    font-family: $bodyfont;
    color: $bodyfontcolor;
}
body{
  width: 100%;
  @include border-box;
}
h1,h2,h3 {
    font-family: $headerfont;
    font-weight: bold;
    line-height: 1.4;
    color: $headerfontcolor;
}
h1{
  font-size: 1.3rem;
}
h2{ 
  font-size: 1.15rem;
}
h3{
  margin: 1rem 0 .25rem 0;
  font-size: 1rem;
}
a {
    color: $buttoncolor;
}
th, td{vertical-align: top;
text-align: left;
}
td.total{
text-align: right;
}
div.section, section{
  position:relative;
  display: block; 
  clear: both; 
  padding: 0 1rem;
}
input, select, label, textarea{
  font-size: 1.15em;
  @include border-box;
}
label, textarea{
  display: block;
  margin: .75rem 0 0 0;
}
textarea, input[name="label"]{
  width: 100%;
}
input[type="submit"]{
  @include button;
  font-size: 17px;
  font-style: bold;
  margin: 1rem 0;
}
input[type="checkbox"], input[type="radio"]{
  display: inline-block;
  width: auto;
}

p{
  font-size: 15px;
  line-height: 1.4;
}
a:active{
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,lighten($buttoncolor, 15%)), color-stop(100%,$buttoncolor));
  -webkit-tap-hightlight-color:-webkit-gradient(linear, left top, left bottom, color-stop(0%,lighten($buttoncolor, 15%)), color-stop(100%,$buttoncolor));
  color: $buttontext !important;
  text-shadow: 0 1px 0 fade-out(invert($buttontext), .5);
}
#home{
  display:block;
    visibility: hidden;
    position: absolute;
    top:0;
}

nav ul, .prices{
    list-style-type: none;
    margin: 0;
    padding: 0;
}
#banner{
  overflow: auto; 
    padding: .5em;
    h2{
      max-width: 50%;
        float: left; 
        margin: 0;
    }
    nav{
      float:right;
      padding: 5px;
      ul li{
        display: inline-block;
      }
      a{
        @include button;
      }
    }
}
.inset-left{
  float:left; 
  margin: 0 10px 10px 0;
  max-width: 50%; 
  background-size: auto auto;
}
.place-order{
  border-bottom: 1px solid $accentcolor;
  overflow: auto;
  padding: .5rem 0;
}
div.cart{
  background: $mastheadbackgroundcolor;
  color: #fff;
  padding: 5px;
  overflow: auto;
  a.button{
    @include button;
      float: right;
      font: normal 14px/1 sans-serif;
  }
}
.maplink{
  @include border-box;
    display: block; 
  height: 220px;
  width: 100%;
  background-position: center 10px;
  background-repeat: no-repeat;
  background-color: rgba(0,0,0,.3);
}
#contact{
  @include border-box;
    -webkit-transition: all 350ms cubic-bezier(0.455, 0.030, 0.515, 0.955);
  position:absolute;
  width: 100%;
  background: lighten($centercolor, 20%);
  top: 0;
  overflow-x:hidden;
  left: 0;
  -webkit-transform: translate3d(100%, 0, 0);
  height: auto;
  padding-bottom: 2rem;

  address, h2{
    padding-left: 1em;
    margin-bottom: 0;
  }
  .box-wrap{
    display: -webkit-box;
    -webkit-box-orient: horizontal;
  }
  .hours{
  text-align: right;
  }
  .communicate{
  text-align: left;
  }
  .map-link{
    margin-bottom: 1em;
  }
  .half{
    padding: 1em .5em;
    -webkit-box-flex: 1;
  }
  .twitter{
    background: url({{MEDIA_URL}}img/twitter_newbird_white.png) center 10px 
    no-repeat;
  }
  .facebook{
    background: url({{ MEDIA_URL }}img/f_logo.png) center 10px no-repeat;
  }
  .twitter, .facebook{
    background-size: auto 50px;
    padding:.75em ;
    margin: 1em;
    background-color: rgba(0,0,0,.4);
    text-align: center;
    min-height: 50px;
    border-radius:15px;
    border-bottom: 1px solid rgba(255,255,255, .3);
    a{
        padding-top:60px;
        display: block;
        border-radius:12px;
    }
  }
}

.mailchimp{
    background-color: rgba(0,0,0,.4);
    text-align: center;
    border-radius:15px;
    padding: 1em;
    margin: 1em;
    border-bottom: 1px solid rgba(255,255,255, .3);

}
#contact:target{
  -webkit-transform: translate3d(0, 0, 0);
  overflow:auto;
}
body.menu section{
  padding: 0;
}
#sectionList, #items, .upgrades ul{
    @include ul-reset;
    li{
    @if lightness($centercolor) <= 50 {
        // color is dark, so make the top lighter
        background: -webkit-gradient(linear, left top, left bottom,
        color-stop(0%,lighten($centercolor, 15%)), color-stop(60%,$centercolor));
    } @else {
        // color is light so make the bottom darker
        background: -webkit-gradient(linear, left top, left
        bottom,color-stop(0%,$centercolor), color-stop(60%,darken($centercolor,
        15%)));
    }
        overflow: hidden;
        a{
            display: block;
            padding: 0 1rem;
            text-decoration: none;
            color: inherit;
            font-size: 1.2rem;
            border: 1px solid grayscale($accentcolor);
            border-width: 1px 0 1px 0;
            border-top-color: fade-out(grayscale($accentcolor), .7);
            p{
              margin: 0 0 1rem 0;
            }
          }
          a:active h3{
            color: $buttontext;
          }
        }
}
.extra label{
    display: -webkit-box;
    -webkit-box-orient: horizontal;
    border-bottom: 1px solid #ccc;
    padding: .5rem;
      .extra-name{
          -webkit-box-flex: 1;
          margin: 0;
          color: $bodyfontcolor;
          font-family: $bodyfont;
        }
      .price{
          -webkit-box-flex: 1;
          font-family: $emphasisfont;
          color: $buttoncolor;
          line-height: 1.4;
          font-size: 14px;
      }
}

h2.price{ text-align: right;}
#sectionDetail > p, #sectionDetail .breadcrumb,
h1, #itemDetail, footer{ padding: 0 1rem;}
#itemDetail h1{ padding: 0; }
header{
  background: $mastheadbackgroundcolor;
  color: $mastheadtextcolor;
  border-bottom: 1px solid $accentcolor;
  h2 a{color: $mastheadtextcolor;}
}
footer{
  border: 1px solid $accentcolor;
  border-width: 1px 0;
  background: $footerbackground;
  overflow: hidden;
  margin: 1rem 0 0 0;
  color: $footertext;
  a{color: $footerlink}
  }
  @mixin block-input{
    font:inherit;
    display: block;
    @include round-corners(5px);
  }
  label {
    font-size: 1.15rem;
    input{
      @include block-input;
      width: 100%;
       }
  }
  input[name="notes"], input[name="label"] {
      @include block-input;
  }
  input[type="submit"].ordering{
    -webkit-appearance: none;
    border:none;

  background: -webkit-gradient(linear, left top, left bottom,
  color-stop(0%,lighten($buttoncolor, 25%)), color-stop(100%,$buttoncolor));
    display: block;
    width: 100%;
    text-align: center;
    text-shadow: 0 1px 0 rgba(255,255,255,.75);
  }
  select{
    width: 100%;
    display:block;
    font-size: 1.15rem;
  }
  .breadcrumbs a {
    color: $buttoncolor;
    font-size: .9rem;
  } 
  .breadcrumbs a::before{
    content: '< ';
    text-decoration: none;
    height: 5px;
    width: 5px;
    position: relative;
  }
        </style>
        {% endcompress %}
    </head>
    <body class="{% block body_class %}{% endblock %}">
        <span id="home"></span>
        <header>
        {% block cart %}
        <div class="cart">
            {% if site.enable_orders %}
            {% if cart|length %}
            <a class="button ordering" href="/menu/#review">{{ cart|length }} </a>
            {% else %}
            <div class="place-order">
                <span>Hungry?</span>
            <a class="button primary" href="{% url menu_home %}">Place an order</a>
        </div>
            {% endif %}
            {% endif %}
        </div>
        {% endblock %}
        <div id="banner">
            {% block logo %}
            <h2><a href="/">{{ site.name }}</a></h2>
            {% endblock %}
            {% block menu %}
            <nav>
            <ul>
                <li><a id="menu-main" href="{% url menu_home %}">Menu</a></li>
                <li><a href="#contact" class="contact">Contact</a></li>
            </ul>
            </nav>
            {% endblock %}  
        </div>
        </header>
        <section id="content">
        {% block content %}
        {% endblock %}
        </section>
        {% block pdf %}
        {% if site.menu %}
        <p>
            <a href="{{ site.menu.url }}">Download our menu (PDF)</a> 
        </p>
        {% endif %}
        {% endblock %}
        <footer>
        {% block contact %}
        {{ site.sidebar_locations }}
        {% endblock %}

        {% block social %}
        {% if site.twitter %}
        <div id="twitter">
            <a href="http://twitter.com/{{ site.twitter }}">follow us on Twitter</a>
        </div>
        {% endif %}
        {% if site.facebook %}
        <div id="facebook">
            <a href="{{ site.facebook }}">Facebook</a>!
        </div>
        {% endif %}
        {% endblock %}

        {% block footer %}
        {% block search %}
        <form method="GET" action="{% url menu_search %}">
            {{ search_form.q }} <input type="submit" value="Go" /><br />
        </form>
        {% endblock %}

        <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/about/">About</a></li>
            {% if site.has_news %}
            <li><a href="/news/">News</a></li>
            {% endif %}
            <li><a href="{{ site.tiger_domain }}/dashboard/">Restaurant login</a> </li>
        </ul>
        </nav>
        <p>
            Powered by <a class="lightlink" href="http://www.takeouttiger.com">Takeout Tiger</a> </p> 
        {% endblock %}
        </footer>
        {% block messages %}
        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|safe }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% endblock %}
<div id="contact">
    <a href="#home" class="back-link btn">&larr; Back</a>
    <h1>Contact {{site.name}}</h1>
        {% if site.location_set.count == 1 %}
        {% with site.location_set.all.0 as location %}
        <div class="box-wrap">
        <div class="half hours">
        {{ location.schedule.mobile_schedule|default:'[your restaurant hours]' }}
        </div>
        <div class="half communicate">
        <p> {% if location.phone %}{{ location.phone }}{% else %}[your phone number ]{% endif %}</p>
        <p>{% if location.fax_number %}Fax: {{ location.fax_number }}{% endif %}</p>
        {% if location.email %}
        <p>{{ location.email_display }}</p>
        {% endif %}
    </div>
</div>
<div class="map-link">
        <a href="http://maps.google.com/?q={{ location.address|iriencode }}" class="maplink" style="background: url('http://maps.google.com/maps/api/staticmap?size=640x200&maptype=roadmap&markers=color:red%7C{{ location.address|iriencode }}&sensor=true') center center no-repeat !important;">
    </a>
        {% if location.address %}
        <address>
        <span>{{ location.street }}</spanp>
        <span>{{ location.city }}, {{ location.state }} {{ location.zip_code }}</span>
        </address>
        {% endif %}
    </div>
        {% endwith %}
        {% endif %}
        <h2>Connect with us</h2>
        <div class="box-wrap">
        {% if site.twitter %}
        <div class="twitter half">
            <a href="http://twitter.com/{{ site.twitter }}" target="_blank">@{{ site.twitter }} on Twitter</a>
        </div>
        {% endif %}
        {% if site.facebook %}
        <div class="facebook half">
            <a href="{{ site.facebook }}" target="_blank">Like us on Facebook</a>
        </div>
        {% endif %}
        </div>

        {% block mail %}
        {% if site.mailchimp %}
        <div class="mailchimp">
            <form method="POST" action="{% url mailing_list_signup %}">
                <h2>Join our mailing list!</h2>
                <em>just enter you email below to receive updates</em>
                <input type="text" name="email" /> <input type="submit" value="Join" />
            </form>
        </div>
        {% endif %}
        {% endblock %}

</div>
        {% if not menu_is_cached %}
        <script id="menu-data" type="text/json">
        {{ site.menu_json.data|safe }}
        </script>
        {% endif %}
        <script type="text/javascript" src="{{ MEDIA_URL }}js/underscore.js"></script>
        <script type="text/javascript" src="{{ MEDIA_URL }}js/zepto.js"></script>
        <script type="text/javascript" charset="utf-8">
        var ONLINE_ORDERING = {{ site.enable_orders|lower }};
            // do some dom ready magic here for menu perhaps?
        $(document).ready(function(){
                {# hash to be stored in cookie to check for menu updates #}
                var menu_key = "{{ menu_key }}";
                $('.back-link').bind('touch click', function(e){
                    e.preventDefault();
                    $('body').css('height','auto');
                    history.back();
                    return false;
                });
                $('.contact').bind('touch click', function(e){
                    var cHeight = $('#contact').height();
                    $('body').css('height',cHeight+'px');
                });
                if (readCookie("menu_key") !== menu_key) {
                    localStorage.setItem("menu", $("#menu-data").text());
                    createCookie("menu_key", menu_key, 365);
                }
        });
        </script>
            {% block js %}
            {% endblock %}
        </body>
    </html>
