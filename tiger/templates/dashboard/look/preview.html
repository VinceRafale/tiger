{% extends 'base.html' %}

{% block extrahead %}
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<style type="text/css">
#toolbar {
    background-color: #d2d2d2;
    border-bottom: 1px solid grey;
    width:100%;
}
#toolbar div {
    padding:6px 10px;
}
#toolbar ul {
    float:right;
    list-style-type:none;
    margin:0;
}

#toolbar li {
    display:inline;
}

#toolbar form {
    padding:6px 10px;
}

#toolbar select {
    border: 1px solid grey;
    background-color:white;
    margin-left:10px;
}
</style>
{% endblock %}

{% block toolbar %}
<div id="toolbar">
<div>
<ul>
    <li><button id="save">Save</button></li>
    <li><a class="back" href="{% url dashboard_content %}">Back to dashboard</a></li>
</ul>
{{ form }}
</div>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript">
var skinIdRegex = new RegExp("^{{ MEDIA_URL }}skins/(\\d+)-\\d+\.css$");
$(function () {
    $("#id_skin").change(function () {
        $("link:last").attr("href", $(this).val());
    });
    $("#save").click(function () {
        linkToCss = $(":selected").val();
        console.log(linkToCss);
        console.log(skinIdRegex);
        postVars = $.param({id: skinIdRegex.exec(linkToCss)[1]});
        $.post("{% url select_skin %}", postVars, function (data) {
            alert(data); 
        }, "text");
    });
});
</script>
{% endblock %}
